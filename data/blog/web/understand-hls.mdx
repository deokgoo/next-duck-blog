---
title: 'HLS 스트리밍 이해하기: 적응형 비트레이트와 m3u8 파일 설명'
date: '2025-02-23'
tags: ['HLS', '스트리밍', '적응형 비트레이트', 'm3u8']
draft: false
summary: 'HLS의 개념과 장점, 기존 스트리밍 방식과의 차이점, Safari에서 기본 지원하는 이유, 다른 브라우저에서 사용하는 방법, m3u8 파일 구조 및 예제 코드까지 모두 정리했습니다. 또한 iOS 특정 버전에서 발생하는 HLS.js 스트리밍 이슈와 해결 방법을 추가했습니다.'
---

# HLS 스트리밍 이해하기: 적응형 비트레이트와 m3u8 파일 설명

## HLS란?

HTTP Live Streaming(HLS)은 Apple에서 개발한 적응형 스트리밍 프로토콜입니다. 기본적으로 HTTP를 이용하여 미디어 콘텐츠를 작은 조각(청크) 단위로 전송하며, 네트워크 상태에 따라 적절한 품질의 비디오를 선택할 수 있도록 설계되었습니다.

기존의 스트리밍 방식(RTMP 등)과 비교했을 때 HLS는 HTTP 기반이므로 방화벽 문제를 최소화하며, 적응형 비트레이트(ABR, Adaptive Bitrate)를 지원하여 원활한 재생 환경을 제공합니다.

## 기존 스트리밍 방식과의 차이점

HLS와 기존 스트리밍 방식(RTMP, DASH, MP4 등)의 차이를 정리하면 다음과 같습니다:

| 스트리밍 방식 | 전송 프로토콜 | 방화벽 문제                      | 적응형 비트레이트 지원 | CDN 친화성              | 청크(Chunk) 단위 전송       |
| ------------- | ------------- | -------------------------------- | ---------------------- | ----------------------- | --------------------------- |
| MP4           | HTTP          | 방화벽 문제 없음                 | 지원 안됨              | 제한적 (전체 파일 캐싱) | 지원 안됨 (Range 요청 가능) |
| RTMP          | 전용 프로토콜 | 방화벽에 의해 차단될 가능성 높음 | 제한적                 | 제한적                  | 실시간 전송                 |
| DASH          | HTTP          | 방화벽 문제 없음                 | 지원                   | 가능                    | 지원                        |
| HLS           | HTTP          | 방화벽 문제 없음                 | 강력한 지원            | 매우 유리               | 지원                        |

## HLS를 써야 하는 이유

- **적응형 비트레이트(ABR) 지원**: 사용자의 네트워크 상태에 따라 자동으로 최적의 화질을 선택하여 끊김 없는 스트리밍 제공
- **광범위한 기기 지원**: 스마트폰, 태블릿, PC 등 대부분의 기기에서 지원
- **CDN 친화적**: HTTP 기반이므로 기존 CDN(Content Delivery Network)과 쉽게 통합 가능하며, 정적 파일처럼 캐싱할 수 있어 성능이 향상됨
- **VOD(Video on Demand) 지원**: HLS는 라이브 스트리밍뿐만 아니라 VOD 콘텐츠에도 최적화되어 있으며, 조각난 청크 파일을 이용하여 빠르고 안정적인 재생 환경을 제공합니다.

## Safari는 기본 지원, 다른 브라우저는 라이브러리 필요

Apple이 개발한 프로토콜이므로 **Safari에서는 기본적으로 HLS를 지원**합니다. 하지만 Chrome, Firefox, Edge 등의 브라우저에서는 기본 지원되지 않으며, 이를 위해 **HLS.js** 같은 라이브러리를 사용해야 합니다.

### HLS.js를 이용한 HLS 스트리밍 예제

```html
<video id="video" controls></video>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
  if (Hls.isSupported()) {
    var video = document.getElementById('video');
    var hls = new Hls();
    hls.loadSource('https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8');
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, function () {
      video.play();
    });
  }
</script>
```

## HLS의 주요 포맷과 m3u8 파일 구조

HLS에서 가장 중요한 요소는 **m3u8** 파일입니다. 이는 재생 가능한 미디어 청크 목록을 포함하는 **플레이리스트 파일**로, 아래와 같은 구조를 가집니다.

```m3u8
#EXTM3U
#EXT-X-STREAM-INF:BANDWIDTH=800000,RESOLUTION=640x360
https://example.com/low/index.m3u8
#EXT-X-STREAM-INF:BANDWIDTH=1400000,RESOLUTION=1280x720
https://example.com/mid/index.m3u8
#EXT-X-STREAM-INF:BANDWIDTH=2800000,RESOLUTION=1920x1080
https://example.com/high/index.m3u8
```

## Safari에서 MSE 방식 사용 및 iOS 특정 버전에서 발생하는 문제

일관성을 유지하기 위해 Safari에서도 MSE 방식을 활용하여 HLS.js를 통한 스트리밍을 적용했습니다. 하지만 iOS 특정 하위 버전(15, 16)에서 HLS.js 기반 MSE 스트리밍이 정상적으로 작동하지 않는 문제가 발견되었습니다.

### ⚠️ 원인

- iOS 15, 16에서도 MSE(Media Source Extensions) 지원됨으로 표시되지만,
- HLS.js 기반 MSE 스트리밍이 불안정하여 정상 재생되지 않음
- iOS 17부터 HLS.js를 활용한 MSE 스트리밍이 안정적으로 동작함

### 🔷 적용 방식

✅ **iOS 15~16:** `Hls.js ❌` → **네이티브 HLS (`video.src = url`) ✅**

이를 통해 iOS의 경우 네이티브 HLS를 활용하여 스트리밍하도록 예외처리하여 문제를 해결하였습니다.

## 결론

HLS는 현대적인 스트리밍 방식으로, 네트워크 환경에 최적화된 적응형 스트리밍을 제공합니다. Safari에서는 기본 지원되지만 다른 브라우저에서는 HLS.js 같은 라이브러리를 활용해야 합니다. 또한, iOS 15~16 버전에서는 HLS.js 기반 MSE 스트리밍이 원활하게 동작하지 않으므로, 네이티브 HLS를 활용하여 해결하는 것이 바람직합니다.
